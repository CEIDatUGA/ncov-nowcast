---
title: "Nowcasts for the US, states, and territories"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    df_print: paged
---

<!-- Knit this page first -->

```{r setup, include=FALSE}

knitr::opts_chunk$set(
  echo=FALSE, message = FALSE, warning = FALSE, cache = FALSE, out.width = '100%'
)

# source('R/run_nowcast_US.R') # replace with sourcing in crontab

library(tidyverse)
source('R/nowcast.R')
#source('R/data.R')

params.US <- readRDS("data/params.US.rds")

load_nowcast <- function(admin) {
  readRDS(paste0("data/output/", admin, ".nowcast.from.cases.rds"))
}

US <- load_nowcast("US")

cases.US <- readRDS('data/cases.US.rds')
statesvector <- cases.US %>% select(-Date, -US) %>% names()

for(s in statesvector) {
  assign(s, load_nowcast(s), envir = .GlobalEnv)
}

# start.time <- proc.time()
```

## {.tabset .tabset-fade}

### USA

```{r US}

# Plot_R_effective(US, legend = FALSE)

# Export single plot
p <- plot_nowcast_from_case_reports(US, plotcumulative = TRUE, maxy = 10^8, legend = FALSE)
htmlwidgets::saveWidget(p, "USnowcast_plot.html")

# plot inline
plot_nowcast_from_case_reports(US, maxy = 10^8, legend = FALSE)
```

### AK
```{r AK}
plot_nowcast_from_case_reports(AK, maxy = 10^7)
```

### AL
```{r AL}
plot_nowcast_from_case_reports(AL, maxy = 10^7)
```

### AR
```{r AR}
plot_nowcast_from_case_reports(AR,  maxy = 10^7)
```

### AZ
```{r AZ}
plot_nowcast_from_case_reports(AZ,  maxy = 10^7)
```

### CA
```{r CA}
plot_nowcast_from_case_reports(CA,  maxy = 10^7)
```

### CO
```{r CO}
plot_nowcast_from_case_reports(CO,  maxy = 10^7)
```

### CT
```{r CT}
plot_nowcast_from_case_reports(CT,  maxy = 10^7)
```

### DC
```{r DC}
plot_nowcast_from_case_reports(DC,  maxy = 10^7)
```

### DE
```{r DE}
plot_nowcast_from_case_reports(DE,  maxy = 10^7)
```

### FL
```{r FL}
plot_nowcast_from_case_reports(FL,  maxy = 10^7)
```

### GA
```{r GA}
plot_nowcast_from_case_reports(GA,  maxy = 10^7)

GA <- readRDS("data/output/GA.nowcast.from.cases.rds")
# Export single plot
p <- plot_nowcast_from_case_reports(GA, plotcumulative = TRUE, maxy = 10^7, legend = FALSE)
htmlwidgets::saveWidget(p, "GAnowcast_plot.html")

```

### HI
```{r HI}
plot_nowcast_from_case_reports(HI,  maxy = 10^7)
```

### IA
```{r IA}
plot_nowcast_from_case_reports(IA,  maxy = 10^7)
```

### ID
```{r ID}
plot_nowcast_from_case_reports(ID,  maxy = 10^7)
```

### IL
```{r IL}
plot_nowcast_from_case_reports(IL,  maxy = 10^7)
```

### IN
```{r IN}
plot_nowcast_from_case_reports(IN,  maxy = 10^7)
```

### KS
```{r KS}
plot_nowcast_from_case_reports(KS,  maxy = 10^7)
```

### KY
```{r KY}
plot_nowcast_from_case_reports(KY,  maxy = 10^7)
```

### LA
```{r LA}
plot_nowcast_from_case_reports(LA,  maxy = 10^7)
```

### MA
```{r MA}
plot_nowcast_from_case_reports(MA,  maxy = 10^7)
```

### MD
```{r MD}
plot_nowcast_from_case_reports(MD,  maxy = 10^7)
```

### ME
```{r ME}
plot_nowcast_from_case_reports(ME,  maxy = 10^7)
```

### MI
```{r MI}
plot_nowcast_from_case_reports(MI,  maxy = 10^7)
```

### MN
```{r MN}
plot_nowcast_from_case_reports(MN,  maxy = 10^7)
```

### MO
```{r MO}
plot_nowcast_from_case_reports(MO,  maxy = 10^7)
```

### MS
```{r MS}
plot_nowcast_from_case_reports(MS,  maxy = 10^7)
```

### MT
```{r MT}
plot_nowcast_from_case_reports(MT,  maxy = 10^7)
```

### NC
```{r NC}
plot_nowcast_from_case_reports(NC,  maxy = 10^7)
```

### ND
```{r ND}
plot_nowcast_from_case_reports(ND,  maxy = 10^7)
```

### NE
```{r NE}
plot_nowcast_from_case_reports(NE,  maxy = 10^7)
```

### NH
```{r NH}
plot_nowcast_from_case_reports(NH,  maxy = 10^7)
```

### NJ
```{r NJ}
plot_nowcast_from_case_reports(NJ,  maxy = 10^7)
```

### NM
```{r NM}
plot_nowcast_from_case_reports(NM,  maxy = 10^7)
```

### NV
```{r NV}
plot_nowcast_from_case_reports(NV,  maxy = 10^7)
```

### NY
```{r NY}
plot_nowcast_from_case_reports(NY,  maxy = 10^7)
```

### OH
```{r OH}
plot_nowcast_from_case_reports(OH,  maxy = 10^7)
```

### OK
```{r OK}
plot_nowcast_from_case_reports(OK,  maxy = 10^7)
```

### OR
```{r OR}
plot_nowcast_from_case_reports(OR,  maxy = 10^7)
```

### PA
```{r PA}
plot_nowcast_from_case_reports(PA,  maxy = 10^7)
```

### RI
```{r RI}
plot_nowcast_from_case_reports(RI,  maxy = 10^7)
```

### SC
```{r SC}
plot_nowcast_from_case_reports(SC,  maxy = 10^7)
```

### SD
```{r SD}
plot_nowcast_from_case_reports(SD,  maxy = 10^7)
```

### TN
```{r TN}
plot_nowcast_from_case_reports(TN,  maxy = 10^7)
```

### TX
```{r TX}
plot_nowcast_from_case_reports(TX,  maxy = 10^7)
```

### UT
```{r UT}
plot_nowcast_from_case_reports(UT,  maxy = 10^7)
```

### VA
```{r VA}
plot_nowcast_from_case_reports(VA,  maxy = 10^7)
```

### VT
```{r VT}
plot_nowcast_from_case_reports(VT,  maxy = 10^7)
```

### WA
```{r WA}
plot_nowcast_from_case_reports(WA,  maxy = 10^7)
```

### WI
```{r WI}
plot_nowcast_from_case_reports(WI,  maxy = 10^7)
```

### WY
```{r WY}
plot_nowcast_from_case_reports(WY,  maxy = 10^7)
```

### Guam
```{r GU}
plot_nowcast_from_case_reports(GU,  maxy = 10^7)
```

### Northern Mariana Islands
```{r MP}
plot_nowcast_from_case_reports(MP)
```

### Puerto Rico
```{r PR}
plot_nowcast_from_case_reports(PR,  maxy = 10^7)
```

### US Virgin Islands
```{r VI}
plot_nowcast_from_case_reports(VI,  maxy = 10^7)
```

## ![](nowcast-legend-combined.png)

The nowcast for the whole US is calculated from case reports at the national level. It is not the sum of the state level nowcasts. The nowcast for the whole US does not necessarily agree with the the sum of state level nowcasts.

### Parameters

**Infection fatality rate** = `r params.US$IFR`

**Symptom-onset-to-reporting interval:**  
Distribution: `r params.US$effective.infectious.period$dist`  
Mean = `r params.US$effective.infectious.period$mean`  
Shape = `r params.US$effective.infectious.period$shape`

**Incubation period:**  
Distribution: `r params.US$incubation.period$dist`  
Mean = `r params.US$incubation.period$mean`  
Shape = `r params.US$incubation.period$shape`

**Symmptom-onset-to-death interval:**  
Distribution: `r params.US$onset.to.death.period$dist`  
Mean = `r params.US$onset.to.death.period$mean`  
Shape = `r params.US$onset.to.death.period$shape`  
